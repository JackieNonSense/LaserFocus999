# Faster R-CNN Run 2a: Mild repeat-factor sampling (no focal loss)

MODEL:
  WEIGHTS: "detectron2://COCO-Detection/faster_rcnn_R_50_FPN_3x/137849458/model_final_280758.pkl"
  ANCHOR_GENERATOR:
    SIZES: [[8, 12, 16], [24, 32, 40], [48, 64, 80], [96, 128, 160], [192, 224, 256]]
    ASPECT_RATIOS: [[0.5, 1.0, 2.0]]
  ROI_HEADS:
    NUM_CLASSES: 12
    BATCH_SIZE_PER_IMAGE: 512
    SCORE_THRESH_TEST: 0.5

DATASETS:
  TRAIN: ("agropest_train",)
  TEST: ("agropest_valid",)

DATALOADER:
  NUM_WORKERS: 4
  SAMPLER_TRAIN: "RepeatFactorTrainingSampler"
  REPEAT_THRESHOLD: 0.08  # only the rarest classes repeat

SOLVER:
  IMS_PER_BATCH: 4
  BASE_LR: 0.001
  STEPS: (9000, 12000)
  MAX_ITER: 15000
  GAMMA: 0.1
  WARMUP_FACTOR: 0.001
  WARMUP_ITERS: 500
  WARMUP_METHOD: "linear"
  MOMENTUM: 0.9
  WEIGHT_DECAY: 0.0001
  CHECKPOINT_PERIOD: 2500

INPUT:
  MIN_SIZE_TRAIN: (512, 544, 576, 608, 640, 672, 704, 736, 768, 800, 832, 864, 896)
  MAX_SIZE_TRAIN: 1333
  MIN_SIZE_TEST: 704
  MAX_SIZE_TEST: 1333
  RANDOM_FLIP: "horizontal"

TEST:
  EVAL_PERIOD: 2500
  DETECTIONS_PER_IMAGE: 100
  AUG:
    ENABLED: True
    MIN_SIZES: (640, 800, 960)
    MAX_SIZE: 1333
    FLIP: True

OUTPUT_DIR: "./outputs/checkpoints/faster_rcnn_R50_FPN_repeat"

SEED: 42
