
# COMP9517 Project – YOLOv11s Code

This folder contains the code and configuration for the YOLOv11s branch of our group project *“Insect Detection and Classification: A Comparative Study of Machine Learning and Deep Learning Approaches”*.  

This folder represents only the YOLOv11s experimental branch, not the complete project submission.

The provided scripts reproduce the training and evaluation pipeline reported in the YOLOv11s section of the report.

---

## 1. Folder Structure

```text
.
├── archive/
│   ├── data.yaml                  # YOLO dataset configuration (train / val / test)
│   ├── train/                     # Training images and labels (YOLO format)
│   ├── valid/                     # Validation images and labels
│   └── test/                      # Test images and labels
│
├── train_yolo11s.py               # Script for training YOLOv11s
├── eval_yolo11s.py                # Script for validation and metric evaluation
└── insect_detection_project/
    └── yolov11s_run/              # Outputs generated by training
        ├── weights/
        │   ├── best.pt            # Best model checkpoint
        │   ├── last.pt
        ├── results.png            # Training curves
        ├── confusion_matrix.png   # Validation confusion matrix
        └── additional YOLO output files
```

\* The `train/`, `valid/`, and `test/` folders follow the standard YOLO structure:

```
train/
    images/
    labels/

valid/
    images/
    labels/

test/
    images/
    labels/
```

---

## 2. Environment

The code was tested with:

- Python 3.10  
- CUDA GPU (NVIDIA RTX 4060 Laptop)

Main Python packages:

- torch, torchvision  
- ultralytics  
- numpy  
- pandas  
- matplotlib  
- IPython  

Minimal installation:

```bash
pip install torch torchvision ultralytics numpy pandas matplotlib ipykernel
```

---

## 3. How to Run the Notebook

1. Open **9517_project_yolo11s.ipynb** in Jupyter Notebook, JupyterLab, or VS Code.  
2. Make sure the working directory is the project root (the folder containing `archive/` and `9517_project_yolo11s.ipynb`).  
3. The notebook assumes:
   - dataset config at `archive/data.yaml`
   - images/labels inside `archive/train`, `archive/valid`, `archive/test`

### Execution Steps

#### ✔ Reproducibility & Imports
- Sets random seed  
- Checks CUDA  
- Imports YOLO from ultralytics  

#### ✔ Load Base YOLO 11s Model
Loads `yolo11s.pt`.

#### ✔ Training
Uses:

```
results = model.train(
    data='/content/archive/data.yaml',
    epochs=40,
    imgsz=960,
    batch=8,
    device=0,
    project='insect_detection_project',
    name='yolov11s_run',
    mosaic=1.0,
    mixup=0.1,
    copy_paste=0.1,
    close_mosaic=10
)
```

> On a laptop GPU: approx. **1–2 hours**.  
> For marking: **training does not need to be re-run**; saved outputs are already in the notebook.

#### ✔ Display Training Curves
Shows losses, precision, recall, mAP.

#### ✔ Load Best Weights & Validate
Saves:

- `insect_detection_project/yolov11s_run/`

#### ✔ Generate Predictions
Runs:

```
model.predict(source="archive/valid/images", save=True)
```

Outputs saved in `runs/detect/val/`.

---

## 4. Notes for Markers

- The notebook has been fully executed once.  
- All main figures (training curves, confusion matrix, metric tables) are **embedded inside the notebook**.  
- Re-running heavy cells is **not required**.  
- Light cells (visualisation, printing metrics) can be re-run for verification.  
- Code is robust to minor updates in the ultralytics package.